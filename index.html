<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>NovaData API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["curl"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="curl">curl</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://www.novadata.cn/tasks/list'>进入控制台</a></li>
            <li><a href='http://github.com/tripit/slate'>Docs Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="介绍">介绍</h1>

<p>Novadata向用户开放所有数据服务相关的API，API通过 HTTPS GET和HTTP GET两种 方式来进行调用的。在调用API之前，您需要先在控制台申请 API密钥 ， 包括 API密钥ID ( access_key_id ) 和 API密钥的私钥 ( secret_access_key )。 API密钥ID 将作为参数包含在每一个请求中发送；而 API密钥的私钥 负责生成请求串的签名，API密钥的私钥 需要被妥善保管，请勿外传。</p>

<h2 id="api-请求结构">API 请求结构</h2>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>API入口</td>
<td>API 调用的 入口</td>
<td>如：https://api.novadata.com/data/。 完整的列表请参见 <a href="#api列表">API列表</a>。</td>
</tr>
<tr>
<td>公共参数</td>
<td>每个 API 调用都需要包含公共参数</td>
<td>详情可见 <a href="#公共参数">公共参数</a></td>
</tr>
<tr>
<td>特定参数</td>
<td>每个API特定的参数</td>
<td>请参见<a href="#api列表">API列表</a>中的相关文档。</td>
</tr>
</tbody></table>

<h2 id="api-请求样例">API 请求样例</h2>

<p>一个典型的API请求如下所示，这是一个 分页获取数据的API请求:(为了方便查看，我们将文档中的请求都进行换行来显示:)</p>
<pre class="highlight plaintext"><code>https://api.novadata.cn/v1/data/query?access_key_id=NOVADATAACCESSKEYIDEXAMPLE
&amp;limit=200
&amp;signature_version=1
&amp;signature=ihPnXFgsg5yyqhDN2IejJ2%2Bbo89ABQ1UqFkyOdzRITY%3D
</code></pre>

<h2 id="api-返回结构">API 返回结构</h2>

<p>返回结果为 JSON 格式，总体格式如下：</p>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>int</td>
<td>返回码,用来表示API请求的返回值，参见<a href="#返回码">返回码</a></td>
</tr>
<tr>
<td>msg</td>
<td>string</td>
<td>对返回码的详情说明，参见<a href="#返回码">返回码</a></td>
</tr>
<tr>
<td>results</td>
<td>json</td>
<td>返回结果集,请参见每个<a href="#api列表">API列表</a>的相关文档</td>
</tr>
<tr>
<td>total_count</td>
<td>long</td>
<td>根据过滤条件得到的数据总数,请参见每个<a href="#api列表">API列表</a>的相关文档</td>
</tr>
</tbody></table>

          <h1 id="公共参数">公共参数</h1>

<p>公共参数是所有 API 请求都必需的参数。</p>

<aside class="notice">
注解 为减少内容重复，公共参数就不在各API中列出了。
</aside>

<p>公共参数:</p>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>access_key</td>
<td>access key</td>
<td>例如”NovaACCESSKEYIDEXAMPLE”。</td>
</tr>
<tr>
<td>signature_version</td>
<td>签名函数的版本号</td>
<td>目前只支持版本号为 1,签名所用哈希算法为HmacSHA256。</td>
</tr>
<tr>
<td>signature</td>
<td>请求消息的签名</td>
<td>请参见 <a href="#签名方法">签名方法</a></td>
</tr>
</tbody></table>

          <h1 id="签名方法">签名方法</h1>

<p>这里介绍API请求中签名 ( signature ) 的生成方法。签名需要你先在控制台创建 API密钥 ，获得 accesss_key_id 和 secret_access_key.</p>

<blockquote>
<p>这里我们假设</p>
</blockquote>
<pre class="highlight shell"><code>access_key_id <span class="o">=</span> <span class="s1">'NOVADATAACCESSKEYIDEXAMPLE'</span>
secret_access_key <span class="o">=</span> <span class="s1">'SECRETACCESSKEY'</span>
</code></pre>

<blockquote>
<p>例如我们的请求参数如下:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"limit"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"offset"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fields"</span><span class="p">:</span><span class="s2">"data.*"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sort"</span><span class="p">:</span><span class="s2">"price:desc"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"signature_version"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"access_key_id"</span><span class="p">:</span><span class="s2">"NOVADATAACCESSKEYIDEXAMPLE"</span><span class="p">,</span><span class="w">
</span><span class="err">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>注解 你可以使用上述的 AccessKey 和 Request 调试你的代码， 当得到跟后面一致的签名结果后(即表示你的代码是正确的)， 可再换为你自己的 AccessKey 和其他 API 请求。</p>
</blockquote>

<h2 id="1.按参数名进行升序排列">1.按参数名进行升序排列</h2>

<blockquote>
<p>排序后的参数为:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"access_key_id"</span><span class="p">:</span><span class="s2">"NOVADATAACCESSKEYIDEXAMPLE"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fields"</span><span class="p">:</span><span class="s2">"data.*"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"limit"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"offset"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"signature_version"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sort"</span><span class="p">:</span><span class="s2">"price:desc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="2.对参数名称和参数值进行url编码">2.对参数名称和参数值进行URL编码</h2>

<blockquote>
<p>编码后的请求串为:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"access_key_id"</span><span class="p">:</span><span class="s2">"NOVADATAACCESSKEYIDEXAMPLE"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"fields"</span><span class="p">:</span><span class="s2">"data.*"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"limit"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"offset"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="s2">"signature_version"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sort"</span><span class="p">:</span><span class="s2">"price%3Adesc"</span><span class="p">,</span><span class="w">
</span><span class="err">}</span><span class="w">
</span></code></pre>

<h2 id="3.构造url请求">3.构造URL请求</h2>

<p>参数名和参数值之间用”=”号连接，参数和参数之间用”＆”号连接，构造后的URL请求为</p>
<pre class="highlight plaintext"><code>access_key_id=NOVADATAACCESSKEYIDEXAMPLE&amp;fields=data.*&amp;limit=2&amp;offset=10&amp;signature_version=1&amp;sort=price%3Adesc
</code></pre>

<h2 id="4.构造被签名串">4.构造被签名串</h2>

<p>被签名串的构造规则为: 被签名串 = HTTP请求方式 + &ldquo;\n&rdquo; + uri + &ldquo;\n&rdquo; + url 请求串</p>

<blockquote>
<p>注解 &ldquo;\n&rdquo; 是换行符，不要将 &ldquo;\&rdquo; 转义。也就是说，不要用 &ldquo;\n&rdquo; ，有些语言，比如php和ruby，请用 &ldquo;\n&rdquo; , 而不是 &rsquo;\n&rsquo;</p>

<p>假设 HTTP 请求方法为 GET, 请求的uri路径为 &ldquo;/v1/data/websites/1&rdquo;, 则被签名串为</p>
</blockquote>
<pre class="highlight plaintext"><code>GET\n/v1/data/websites/1\naccess_key_id=NOVADATAACCESSKEYIDEXAMPLE&amp;fields=data.*&amp;limit=2&amp;offset=10&amp;signature_version=1&amp;sort=price%3Adesc
</code></pre>

<h2 id="5.计算签名">5.计算签名</h2>

<blockquote>
<p>以 Python 代码为例 (其他语言类似，需要使用 sha256 + base64 编码，最后需要再进行 URL 编码，URL 编码时需要将原有的空格 ” ” 转为 “+”)</p>
</blockquote>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret_access_key</span><span class="p">,</span> <span class="n">digestmod</span><span class="o">=</span><span class="n">sha256</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s">"string_to_sign"</span><span class="p">)</span> <span class="c"># 前面生成的被签名串</span>
<span class="n">sign</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">digest</span><span class="p">())</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">sign</span><span class="p">)</span>
</code></pre>

<blockquote>
<p>Java计算SHA256哈希。Base64编码可以使用apache commons codec,<a href="https://gist.github.com/fivesmallq/9482ca783578f1356243">完整示例代码</a></p>
</blockquote>
<pre class="highlight java"><code>    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">calculateSignature</span><span class="p">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">stringToSign</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">String</span> <span class="n">ENCODING</span> <span class="o">=</span> <span class="s">"UTF-8"</span><span class="o">;</span>
        <span class="kd">final</span> <span class="n">String</span> <span class="n">ALGORITHM</span> <span class="o">=</span> <span class="s">"HmacSHA256"</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">signData</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Mac</span> <span class="n">mac</span> <span class="o">=</span> <span class="n">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">ALGORITHM</span><span class="o">);</span>
            <span class="n">mac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">ENCODING</span><span class="o">),</span> <span class="n">ALGORITHM</span><span class="o">));</span>
            <span class="n">signData</span> <span class="o">=</span> <span class="n">mac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">stringToSign</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">ENCODING</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvalidKeyException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalStateException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">encodeBase64</span><span class="o">(</span><span class="n">signData</span><span class="o">));</span>
    <span class="o">}</span>
</code></pre>

<ul>
<li>将API密钥的私钥 ( secret_access_key ) 作为key，生成被签名串的 HMAC-SHA256 签名，更多信息可参见 <a href="http://www.ietf.org/rfc/rfc2104.txt">RFC2104</a></li>
<li>将签名进行 Base64 编码</li>
<li>将 Base64 编码后的结果进行 URL 编码 （注意，当 Base64 编码后存在空格时，不要对空格进行 URL 编码，而要直接将空格转为”+”）</li>
<li>将签名用于参数”signature”的值。</li>
</ul>

<h2 id="6.添加签名">6.添加签名</h2>

<p>将签名参数附在原有请求串的最后面。最终的HTTP请求串为(为了查看方便，我们人为地将参数之间用回车分隔开)</p>
<pre class="highlight plaintext"><code>access_key_id=NOVADATAACCESSKEYIDEXAMPLE
&amp;fields=data.*
&amp;limit=2
&amp;offset=10
&amp;signature_version=1
&amp;sort=price%3Adesc
&amp;signature=B9willCeoxK2KJLoZNn%2BOXl%2FiXE3Mu815P6y3KLn3CE%3D
</code></pre>

<blockquote>
<p>完整的请求URL为(为了查看方便，我们人为地将参数之间用回车分隔开)</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.novadata.cn/v1/data/website/1?access_key_id=NOVADATAACCESSKEYIDEXAMPLE
&amp;fields=data.*
&amp;limit=2
&amp;offset=10
&amp;signature_version=1
&amp;sort=price%3Adesc
&amp;signature=B9willCeoxK2KJLoZNn%2BOXl%2FiXE3Mu815P6y3KLn3CE%3D
</code></pre>

<blockquote>
<p>实际URL为</p>
</blockquote>
<pre class="highlight plaintext"><code>https://api.novadata.cn/v1/data/website/1?access_key_id=NOVADATAACCESSKEYIDEXAMPLE&amp;fields=data.*&amp;limit=2&amp;offset=10&amp;signature_version=1&amp;sort=price%3Adesc&amp;signature=B9willCeoxK2KJLoZNn%2BOXl%2FiXE3Mu815P6y3KLn3CE%3D
</code></pre>

          <h1 id="返回码">返回码</h1>

<p>当请求发生执行完毕之后，服务器会返回代码 ( code ) 和信息 ( msg ) 以及详细信息( detail )，完整的返回码如下表。</p>

<p>错误分为 客户端错误 和 服务器端错误 两种，如果是客户端错误，说明该错误是由用户提交的API引起的；如果是服务器端错误，说明该错误是由服务器端引起的。</p>

<h2 id="1.普通情况">1.普通情况</h2>

<table><thead>
<tr>
<th>代码</th>
<th>描述</th>
<th>提示</th>
</tr>
</thead><tbody>
<tr>
<td>0</td>
<td>成功执行</td>
<td>请求成功执行</td>
</tr>
<tr>
<td>-1</td>
<td>未知原因</td>
<td>请求出现未知错误</td>
</tr>
</tbody></table>

<h2 id="2.客户端错误">2.客户端错误</h2>

<table>
<colgroup>
<col width="20%">
<col width="30%">
<col width="50%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">代码</th>
<th class="head">错误类型</th>
<th class="head">提示</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1100</td>
<td>消息格式错误</td>
<td>当缺少必要参数，或者参数值格式不正确时，会返回该错误。此时可以查看相关文档确认每个参数的格式是否正确。</td>
</tr>
<tr class="row-odd"><td>1200</td>
<td>身份验证失败</td>
<td><div class="first last line-block">
<div class="line">当用户提供了不存在的access_key_id参数，或者API请求的签名不正确时，会返回该错误。</div>
<div class="line">此时可以检查access_key_id和secret_access_key是否配置正确，或者参考我们的签名文档 <a class="reference internal" href="#签名方法"><em>签名方法</em></a> 检查是否签名有误。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>1300</td>
<td>消息已过期</td>
<td>当用户提交的 <tt class="docutils literal"><span class="pre">time_stamp</span></tt> 参数时间过期(超过60秒)时会返回该错误。关于
<tt class="docutils literal"><span class="pre">time_stamp</span></tt> ，可以参考 <a class="reference internal" href="#公共参数"><em>公共参数</em></a></td>
</tr>
<tr class="row-odd"><td>1400</td>
<td>访问被拒绝</td>
<td><div class="first last line-block">
<div class="line">当用户试图访问不属于自己的资源，或者对于提交的操作没有权限，或者试图更改的资源处于不可更改的状态时等，会返回该错误。</div>
<div class="line">我们会在返回的错误信息里头提及错误原因。</div>
</div>
</td>
</tr>
<tr class="row-even"><td>2100</td>
<td>找不到资源</td>
<td>当用户试图访问不存在的资源时，会返回该错误。</td>
</tr>
<tr class="row-odd"><td>2400</td>
<td>余额不足</td>
<td>当用户余额不足时，会返回该错误。</td>
</tr>
<tr class="row-even"><td>2500</td>
<td>超过配额</td>
<td><div class="first last line-block">
<div class="line">当用户试图创建的资源超过用户配额，或者短时间内的API访问请求超过配额限制，会返回该错误。</div>
<div class="line">您可以通过提交工单的方式来向我们申请提高配额，并说明你申请的理由。</div>
</div>
</td>
</tr>
</tbody>
</table>

<h2 id="3.服务端错误">3.服务端错误</h2>

<table>
<colgroup>
<col width="20%">
<col width="30%">
<col width="50%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">代码</th>
<th class="head">错误类型</th>
<th class="head">提示</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5000</td>
<td>内部错误</td>
<td>当服务器执行请求过程中，遇到未知错误时，会返回该错误信息。遇到这种错误，请及时与我们联系。</td>
</tr>
<tr class="row-odd"><td>5100</td>
<td>服务器繁忙</td>
<td>当服务器执行超时，或者服务器负载过高无法完成请求时，会返回该错误信息。遇到这种错误，请稍后再尝试，或者及时与我们联系。</td>
</tr>
<tr class="row-even"><td>5200</td>
<td>资源不足</td>
<td>当我们后台计算资源不足以满足用户的创建需求时，会返回该错误信息。遇到这种错误，请及时与我们联系。</td>
</tr>
<tr class="row-odd"><td>5300</td>
<td>服务更新中</td>
<td>当我们的后台服务正在更新时，可能会返回该错误信息。遇到这种错误，请稍后再尝试，或者及时与我们联系。</td>
</tr>
</tbody>
</table>

<h2 id="返回样例">返回样例</h2>

<blockquote>
<p>正常情况</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"detail"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"msg"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>错误情况</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"detail"</span><span class="p">:</span><span class="s2">"request param error"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"msg"</span><span class="p">:</span><span class="s2">"请求参数错误,[websiteId]为必须参数"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">1100</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="api列表">API列表</h1>

<p>这里列出所有的API列表。</p>

<ul>
<li><a href="##data-api">Data</a>

<ul>
<li><a href="#get-data">Get Data</a></li>
<li><a href="#delete-data">Delete Data</a></li>
<li><a href="#query-website-data">Query Website Data</a></li>
<li><a href="#archive-website-data">Archive Website Data</a></li>
</ul></li>
</ul>

          <h1 id="data-api">Data API</h1>

<h2 id="get-data">Get Data</h2>

<p>获取单条数据</p>
<pre class="highlight shell"><code>curl <span class="s2">"http://api.novadata.cn/v1/data/1"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:{</span><span class="w">
        </span><span class="s2">"current"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
            </span><span class="s2">"商品价格"</span><span class="p">:</span><span class="s2">"9.90"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"商品全名"</span><span class="p">:</span><span class="s2">"黑胡椒牛排150g"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"总体满意度"</span><span class="p">:</span><span class="s2">"4.9分"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"评论数"</span><span class="p">:</span><span class="s2">"188"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"顶级类别"</span><span class="p">:</span><span class="s2">"蛋肉家禽"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"550be474cf147f2588d3f5cc"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"navigateUrl"</span><span class="p">:</span><span class="s2">"http://www.yummy77.com/category/{page}-98-9804-0-5-p-.html"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="mi">1426842740377</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="s2">"http://www.yummy77.com/product/211013013.html"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://api.novadata.cn/v1/data/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>要获取数据的 id</td>
</tr>
</tbody></table>

<h2 id="delete-data">Delete Data</h2>

<p>删除单条数据</p>
<pre class="highlight shell"><code>curl -X DELETE <span class="s2">"http://api.novadata.cn/v1/data/1"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">2100</span><span class="p">,</span><span class="w">
    </span><span class="s2">"msg"</span><span class="p">:</span><span class="s2">"找不到资源"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://api.novadata.cn/v1/data/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>要删除数据的 id</td>
</tr>
</tbody></table>

<h2 id="query-website-data">Query Website Data</h2>
<pre class="highlight shell"><code>curl <span class="s2">"http://api.novadata.cn/v2/data/websites/551e39610fb408c079b91a82?q=&amp;sort=&amp;offset=2&amp;limit=2&amp;access_key_id=NOVADATAACCESSKEYIDEXAMPLE&amp;signature_version=1&amp;signature=ihPnXFgsg5yyqhDN2IejJ2%2Bbo89ABQ1UqFkyOdzRITY%3D&amp;version=1"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"current"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
                </span><span class="s2">"产品"</span><span class="p">:</span><span class="s2">"常年供应山鸡 量大优惠"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"产地"</span><span class="p">:</span><span class="s2">"产地：山东省 菏泽市"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"价格"</span><span class="p">:</span><span class="s2">"50.00"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"供应商"</span><span class="p">:</span><span class="s2">"嘉祥县阳光食品销售部"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"起订量"</span><span class="p">:</span><span class="s2">"1 - 5000"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"551e42fb5fb4efc40c7de8b4"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"navigateUrl"</span><span class="p">:</span><span class="s2">"http://search.cnhnb.com/product/list?page.orderAsc=false&amp;page.pageNumber=1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="mi">1428046585666</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="s2">"http://www.cnhnb.com/product/137344"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"current"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"data"</span><span class="p">:{</span><span class="w">
                </span><span class="s2">"产品"</span><span class="p">:</span><span class="s2">"百恋鲩鱼（草鱼）"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"产地"</span><span class="p">:</span><span class="s2">"产地：湖南省 长沙市"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"价格"</span><span class="p">:</span><span class="s2">"398.00"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"供应商"</span><span class="p">:</span><span class="s2">"湖南百恋渔业科技有限公司"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"起订量"</span><span class="p">:</span><span class="s2">"1 - 10000"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"551e43265fb4bb6099a375f9"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"navigateUrl"</span><span class="p">:</span><span class="s2">"http://search.cnhnb.com/product/list?page.orderAsc=false&amp;page.pageNumber=1"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"timestamp"</span><span class="p">:</span><span class="mi">1428046629416</span><span class="p">,</span><span class="w">
            </span><span class="s2">"url"</span><span class="p">:</span><span class="s2">"http://www.cnhnb.com/product/327643"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="mi">23295</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>根据查询条件q,分页查询指定website，从起始位置offset开始，其后的limit条数据.</p>

<aside class="note">
q 参数:<br>
field:* 可以查询field不为空的数据，<br>
field:(* AND &ldquo;水果&rdquo;) 可以查询商品名称不为空并且包含水果的数据。</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://api.novadata.cn/v2/data/websites/&lt;WebsiteId&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>WebsiteId</td>
<td>要查询数据的 website id</td>
</tr>
</tbody></table>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>q</td>
<td>string</td>
<td>No</td>
<td>condition expression, see<a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html">Query String</a></td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>No</td>
<td>排序json表达式,默认按数据id升序。例如<code class="prettyprint">post_date:asc,user_name:desc</code>多个条件以逗号分隔</td>
</tr>
<tr>
<td>offset</td>
<td>int</td>
<td>No</td>
<td>起始数据所处偏移,first record  is 0,default value:0</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>No</td>
<td>数据集大小,Default value:100,max value: 10000</td>
</tr>
<tr>
<td>fields</td>
<td>string</td>
<td>No</td>
<td>要返回的字段,默认为空,可以使用<code class="prettyprint">data.title</code>来只返回 data 的 title 字段，多个字段用逗号隔开<code class="prettyprint">data.title,data.body</code>,也可以使用<code class="prettyprint">data.*</code>只返回 data 的全部数据</td>
</tr>
<tr>
<td>start</td>
<td>long</td>
<td>No</td>
<td>查询数据的起始时间戳</td>
</tr>
<tr>
<td>end</td>
<td>long</td>
<td>No</td>
<td>查询数据的结束时间戳</td>
</tr>
<tr>
<td>debug</td>
<td>boolean</td>
<td>No</td>
<td>是否开启 debug，默认为 false，开启debug 模式会返回每条数据对应的 source 数据</td>
</tr>
</tbody></table>

<h2 id="archive-website-data">Archive Website Data</h2>
<pre class="highlight shell"><code>curl <span class="s2">"http://api.novadata.cn/v2/data/websites/551e39610fb408c079b91a82?q=&amp;sort=&amp;offset=2&amp;limit=2&amp;access_key_id=NOVADATAACCESSKEYIDEXAMPLE&amp;signature_version=1&amp;signature=ihPnXFgsg5yyqhDN2IejJ2%2Bbo89ABQ1UqFkyOdzRITY%3D&amp;version=1"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"code"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:{</span><span class="w">
        </span><span class="s2">"download_url"</span><span class="p">:</span><span class="s2">"http://novadata.qiniudn.com/551e39610fb408c079b91a82-553623781bb427ffe372c72f.json?download"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"download_count"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="s2">"file_size"</span><span class="p">:</span><span class="s2">"862 bytes"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"total_count"</span><span class="p">:</span><span class="mi">23297</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>根据websiteId获取起始位置offset后的limit条数据，将这些数据打包archive上传到qiniu进行分发，将对应下载链接返回给用户</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://api.novadata.cn/v2/data/websites/&lt;WebsiteId&gt;/archive</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>WebsiteId</td>
<td>要归档数据的 website id</td>
</tr>
</tbody></table>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>q</td>
<td>string</td>
<td>No</td>
<td>condition expression, see<a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html">Query String</a></td>
</tr>
<tr>
<td>sort</td>
<td>string</td>
<td>No</td>
<td>排序json表达式,默认按数据id升序。例如<code class="prettyprint">post_date:asc,user_name:desc</code>多个条件以逗号分隔</td>
</tr>
<tr>
<td>offset</td>
<td>int</td>
<td>No</td>
<td>起始数据所处偏移,first record  is 0,default value:0</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>No</td>
<td>数据集大小,Default value:100,max value: 10000</td>
</tr>
<tr>
<td>fields</td>
<td>string</td>
<td>No</td>
<td>要返回的字段,默认为空,可以使用<code class="prettyprint">data.title</code>来只返回 data 的 title 字段，多个字段用逗号隔开<code class="prettyprint">data.title,data.body</code>,也可以使用<code class="prettyprint">data.*</code>只返回 data 的全部数据</td>
</tr>
<tr>
<td>start</td>
<td>long</td>
<td>No</td>
<td>查询数据的起始时间戳</td>
</tr>
<tr>
<td>end</td>
<td>long</td>
<td>No</td>
<td>查询数据的结束时间戳</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="curl">curl</a>
          </div>
      </div>
    </div>
  </body>
</html>
